{
  "protocol": "SPARKLE Protocol",
  "version": "0.3.8",
  "test_date": "2025-12-14",
  "test_environment": {
    "bitcoin_core": "v27+",
    "lnd": "v0.18.4-beta",
    "network_tested": ["mainnet", "regtest"]
  },
  "summary": {
    "total_tests": 6,
    "passed": 4,
    "documented": 1,
    "skipped": 1,
    "status": "PRODUCTION_READY"
  },

  "mainnet_proofs": {
    "happy_path": {
      "status": "COMPLETE",
      "on_chain": {
        "lock_txid": "a3c6b08ed820194ee3274a3eae945071c2ed33105b41db207cd16c9661de28a7",
        "lock_block": 927703,
        "sweep_txid": "9422e6cb358295d86ad6d73bc0566c869aa0be8290c60598be205f4eea9ce50b",
        "sweep_block": 927703
      },
      "lightning": {
        "payment_hash": "1b812c64655e9ca5e002c16a6f932b6ce95eee29a4f7b7227b371f005b027626",
        "preimage": "b0f0af91b3602129c38f3db8febdeecb9e5507ca816116616e360738b58830e9",
        "amount_sats": 5000,
        "state": "SETTLED"
      },
      "inscription": {
        "id": "Darkita #1 Test",
        "before_lock": "16d7a2d5e542ca56ea3cd77fc9d650acf7fef2ce5a9c488a4e981d59bdd96d60:1:0",
        "after_lock": "a3c6b08ed820194ee3274a3eae945071c2ed33105b41db207cd16c9661de28a7:0:0",
        "after_sweep": "9422e6cb358295d86ad6d73bc0566c869aa0be8290c60598be205f4eea9ce50b:0:0"
      },
      "cryptographic_binding": {
        "verified": true,
        "sha256_preimage_equals_hash": true
      }
    }
  },

  "regtest_tests": {
    "TEST_1_refund_path": {
      "priority": "CRITICAL",
      "status": "PASS",
      "purpose": "Prove seller can recover inscription after timelock expires",
      "results": {
        "timelock_height": 641,
        "lock_txid": "d7540122f99477ee075bd06336563c196e34d792d4761a44a6ab445111f6cd54",
        "refund_txid": "144058c727e40bbc41edd8408568400cb55f57c6d53f7343b4290d35924d28c0",
        "early_refund_rejected": true,
        "rejection_reason": "non-final"
      },
      "conclusion": "Seller successfully recovered funds via timelock refund path"
    },

    "TEST_2_buyer_fails_claim": {
      "priority": "HIGH",
      "status": "DOCUMENTED",
      "purpose": "Document buyer-loss scenario (paid but didn't claim)",
      "results": {
        "invoice_paid": true,
        "preimage_received": true,
        "claim_broadcast": false,
        "timelock_expired": true,
        "buyer_outcome": "LOST_PAYMENT",
        "seller_outcome": "RECOVERED_INSCRIPTION"
      },
      "lesson": "Buyers MUST broadcast claim TX immediately after receiving preimage",
      "mitigation": "SPARKLE client auto-broadcasts claim upon Lightning settlement"
    },

    "TEST_3_double_spend_prevention": {
      "priority": "HIGH",
      "status": "PASS",
      "purpose": "Verify seller cannot double-spend locked inscription",
      "results": {
        "lock_txid": "b2857bb868d32fe76028a2b1fa4949e3c888196288875d4b3ff45441b66b2554",
        "lock_confirmed_height": 638,
        "double_spend_result": "REJECTED",
        "rejection_reason": "bad-txns-inputs-missingorspent"
      },
      "conclusion": "Once lock TX is confirmed, inscription is secured against double-spend"
    },

    "TEST_4_cpfp_fee_bump": {
      "priority": "MEDIUM",
      "status": "PASS",
      "purpose": "Demonstrate CPFP can accelerate stuck claim TX",
      "results": {
        "claim_txid": "c6e7ca3cda42cd406931d55a1bb7695095c71f4e0b09a0937a053cf84b2f28aa",
        "claim_fee_sats": 1000,
        "cpfp_txid": "85bade26094611c3d0a88ed99e599a8d10e728e384573e3448d2460d6175a5bd",
        "cpfp_fee_sats": 10000,
        "combined_effective_rate": "32 sat/vB",
        "same_block_confirmation": true
      },
      "conclusion": "CPFP successfully accelerated stuck claim TX"
    },

    "TEST_5_signer_compatibility": {
      "priority": "MEDIUM",
      "status": "SKIPPED",
      "reason": "Requires multiple wallet integrations - deferred to v0.4",
      "planned_signers": ["bitcoinjs-lib", "Sparrow", "Bitcoin Core"]
    },

    "TEST_6_force_close": {
      "priority": "LOW",
      "status": "SKIPPED",
      "reason": "Requires dual LND regtest setup - optional for production",
      "note": "HTLC timeout resolution documented in LND specs"
    }
  },

  "key_findings": {
    "atomicity": "Protocol is atomic ONLY if buyer claims within timelock window",
    "security": "Double-spend protection verified via Bitcoin consensus rules",
    "recoverability": "Seller can always recover via timelock refund path",
    "fee_flexibility": "CPFP allows fee bumping for stuck transactions",
    "minimum_timelock": "Recommended: 6+ blocks for safety margin",
    "buyer_responsibility": "Client must auto-claim immediately upon preimage receipt"
  },

  "production_checklist": {
    "happy_path_tested": true,
    "refund_path_tested": true,
    "double_spend_protection_tested": true,
    "cpfp_recovery_tested": true,
    "edge_cases_documented": true,
    "mainnet_transactions_confirmed": true,
    "lightning_integration_verified": true
  },

  "resources": {
    "github": "https://github.com/ProtocolSparkle/Sparkle-Protocol",
    "website": "https://sparkleprotocol.com",
    "mainnet_report": "SPARKLE_MAINNET_COMPLETE_PROOF_REPORT.md"
  },

  "generated_by": "SPARKLE Protocol",
  "timestamp": "2025-12-14T05:50:00Z"
}
